"use strict";var K=Object.create;var m=Object.defineProperty;var f=Object.getOwnPropertyDescriptor;var T=Object.getOwnPropertyNames;var k=Object.getPrototypeOf,$=Object.prototype.hasOwnProperty;var x=(t,e)=>{for(var i in e)m(t,i,{get:e[i],enumerable:!0})},g=(t,e,i,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of T(e))!$.call(t,r)&&r!==i&&m(t,r,{get:()=>e[r],enumerable:!(n=f(e,r))||n.enumerable});return t};var l=(t,e,i)=>(i=t!=null?K(k(t)):{},g(e||!t||!t.__esModule?m(i,"default",{value:t,enumerable:!0}):i,t)),q=t=>g(m({},"__esModule",{value:!0}),t),h=(t,e,i,n)=>{for(var r=n>1?void 0:n?f(e,i):e,d=t.length-1,c;d>=0;d--)(c=t[d])&&(r=(n?c(e,i,r):c(r))||r);return n&&r&&m(e,i,r),r},p=(t,e)=>(i,n)=>e(i,n,t);var L={};x(L,{default:()=>D});module.exports=q(L);var u=l(require("../../lib/decorators/MessageListener")),w=require("../../lib/filter"),M=l(require("../../lib/decorators/Message")),s=l(require("../../../../prisma/client")),y=require("../../utils/isAdmin"),b=l(require("../../constants")),C=l(require("../../lib/decorators/Client"));let o=class{async handler(e,i){try{if(!await(0,y.isAdmin)(e.author.id)){await e.reply({content:"Kh\xF4ng ph\u1EA3i admin!"});return}const n=await s.default.discordMeet.findUnique({where:{channel:e.channel.id,isActive:!0}});if(!n){await e.reply({content:"Meeting kh\xF4ng t\u1ED3n t\u1EA1i..."});return}const r=await s.default.discordMember.findMany(),d=i.channels.cache.find(a=>a.id===b.default.notifyChannel),c=n.joined.split(" ");for(const a of r)if(!c.includes(a.discordId))if(a.missTime==2){try{await e.guild.members.kick(a.discordId,"Kick do qu\xE1 2 l\u1EA7n kh\xF4ng tham gia meet!")}catch(I){e.reply({content:`Kh\xF4ng th\u1EC3 KICK do ${I.toString()}`});return}await d.send(`<@${a.discordId}> aka ${a.username} \u0111\xE3 b\u1ECB KICK kh\u1ECFi nh\xF3m do qu\xE1 2 l\u1EA7n kh\xF4ng tham gia meet.`),await s.default.discordMember.update({where:{discordId:a.discordId},data:{missTime:0}})}else d.send(`C\u1EA3nh b\xE1o: <@${a.discordId}> kh\xF4ng tham gia meeting l\xFAc ${new Date(n.createdAt).toLocaleString("vi-VN")}, qu\xE1 2 l\u1EA7n, b\u1EA1n s\u1EBD t\u1EF1 \u0111\u1ED9ng b\u1ECB KICK!`),await s.default.discordMember.update({where:{discordId:a.discordId},data:{missTime:a.missTime+1}});await s.default.discordMeet.delete({where:{channel:e.channel.id}}),await e.reply({content:"Bu\u1ED5i meet \u0111\xE3 k\u1EBFt th\xFAc! C\u1EA3m \u01A1n c\xE1c b\u1EA1n \u0111\xE3 tham gia..."})}catch(n){await e.reply({content:`C\xF3 l\u1ED7i x\u1EA3y ra ${n.toString()}`})}}};h([p(0,(0,M.default)()),p(1,C.default)],o.prototype,"handler",1),o=h([(0,u.default)([w.Filter.startWith("*end meeting")])],o);var D=o;
